[
    {
        "role": "system",
        "content": "You are given a task and an incorrect solution to the task."
    },
    {
        "role": "user",
        "content": "Task:\nYou are given three 3D PyTorch tensors Q (batch_size, input_len, d_K), K (batch_size, output_len, d_K) and V (batch_size, output_len, d_V). Your task is to compute an output (batch_size, output_len, d_V) using only computations performed on the three given tensors.\n\nInstructions:\nCorrect the solution to satisfy the task constraints. Do not change the name of the function or the number of arguments. Return the full corrected ```algorithm``` function.\n\nHint:\nUse the print statement to help you construct the correct solution.\n\nIncorrect Solution:\n```python\nimport torch\n\n\ndef algorithm(\n    Q: torch.Tensor, \n    K: torch.Tensor, \n    V: torch.Tensor\n) -> torch.Tensor:\n    '''\n    args:\n        Q: torch.Tensor of shape (batch_size, input_len, d_K)\n        K: torch.Tensor of shape (batch_size, output_len, d_K)\n        V: torch.Tensor of shape (batch_size, output_len, d_V)\n\n    return:\n        output: torch.Tensor of shape (batch_size, input_len, d_V)\n    '''\n    print(f'Q, K, V shapes: {Q.shape} {K.shape} {V.shape}')  # prints 'Q, K, V shapes: ' followed by the three tensors' shapes to the console\n    scores = torch.matmul(Q, K.transpose(-2, -1))\n    output = torch.matmul(V.transpose(-2, -1), scores.transpose(-2, -1))\n    return output\n```\n"
    }
]